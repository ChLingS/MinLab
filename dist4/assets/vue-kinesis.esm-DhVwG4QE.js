import{a as m,j as v,w as y,k as M,f as x,g as b,l as w}from"./index-baJIFZFR.js";var P={props:{type:{type:String,default:"translate"},transformOrigin:{type:String,default:"center"},originX:{type:Number,default:50},originY:{type:Number,default:50},strength:{type:Number,default:10},audioIndex:{type:Number,default:50},axis:{type:String,default:null},maxX:{type:Number,default:null},maxY:{type:Number,default:null},minX:{type:Number,default:null},minY:{type:Number,default:null},cycle:{type:Number,default:0}},methods:{strengthManager(){return this.type==="depth"||this.type==="depth_inv"?Math.abs(this.strength):this.strength}}};function S(t){return t.bottom>=0&&t.right>=0&&t.top<=(window.innerHeight||document.documentElement.clientHeight)&&t.left<=(window.innerWidth||document.documentElement.clientWidth)}function X(t,e,n){let i,s;return function(){const r=this;let a;n==="scroll"?a=e:a=r.duration>1e3?e:r.duration/10;const o=+new Date,l=arguments;i&&o<i+a?(clearTimeout(s),s=setTimeout(()=>{requestAnimationFrame(()=>{i=o,t.apply(r,l)})},a)):requestAnimationFrame(()=>{i=o,t.apply(r,l)})}}var Y={props:{active:{type:Boolean,default:!0},duration:{type:Number,default:1e3},easing:{type:String,default:"cubic-bezier(0.23, 1, 0.32, 1)"},tag:{type:String,default:"div"}}},$={props:{perspective:{type:Number,default:1e3}},computed:{style(){return{perspective:`${this.perspective}px`}}}},A={props:{audio:{type:String,required:!1},playAudio:{type:Boolean,default:!1}},data(){return{analyser:null,audioArray:null,audioData:null,audioRef:null,wasPlayed:!1,isPlaying:!1}},watch:{audio(){this.wasPlayed=!1,this.isPlaying=!1},playAudio(t){t?this.play():this.stop()}},methods:{play(){this.active&&(this.wasPlayed||(this.handleAudio(),this.wasPlayed=!0),this.isPlaying=!0,this.audioRef.play(),this.getSongData())},stop(){this.isPlaying=!1,this.audioRef.pause()},handleAudio(){const{audio:t}=this.$refs;this.audioRef=t;const e=new AudioContext,n=e.createMediaElementSource(t),i=e.createAnalyser();n.connect(i),i.connect(e.destination),i.fftSize=256;const s=i.frequencyBinCount,r=new Uint8Array(s);this.audioArray=r,this.analyser=i},getSongData(){this.isPlaying&&(this.analyser.getByteFrequencyData(this.audioArray),this.audioData=new Array(this.audioArray),requestAnimationFrame(this.getSongData))}}};function d(){try{return/Mobi|Android/i.test(navigator.userAgent)}catch{return!0}}var D={props:{event:{type:String,default:"move"}},data(){return{eventMap:{orientation:"deviceorientation",scroll:"scroll",move:d()?"deviceorientation":null}}},methods:{addEvents(){this.eventMap[this.event]&&window.addEventListener(this.eventMap[this.event],this.handleMovement,!0)},removeEvents(){this.eventMap[this.event]&&window.removeEventListener(this.eventMap[this.event],this.handleMovement,!0)}},watch:{event(t,e){this.eventMap[t]&&window.addEventListener(this.eventMap[t],this.handleMovement,!0),this.eventMap[e]&&window.addEventListener(this.eventMap[e],this.handleMovement,!0)}}};function c(t,e){return{x:t,y:e}}function E(t){return c(t?t.width/2:0,t?t.height/2:0)}function N(t){const{target:e,event:n}=t,i=n.clientX,s=n.clientY,r=i-e.left,a=s-e.top,o=E(e),l=r/o.x,h=a/o.y;return{...c(l,h),target:e}}function C(t){const{event:e,target:n}=t,i=e.gamma/45,s=e.beta/90;return{...c(i,s),target:n}}function T(t){const e=(t.left-window.innerWidth)/(t.width+window.innerWidth),n=(t.top-window.innerHeight)/(t.height+window.innerHeight);return{...c(e,n),target:t}}var k={name:"KinesisContainer",mixins:[Y,$,A,D],provide(){const t={};return["audioData","duration","easing","event","eventData","isMoving","movement","shape"].forEach(n=>Object.defineProperty(t,n,{enumerable:!0,get:()=>this[n]})),{context:t}},data(){return{movement:{x:0,y:0},isMoving:!1,shape:null,leftOnce:!1,eventData:{x:0,y:0}}},mounted(){this.addEvents()},beforeUnmount(){this.removeEvents()},methods:{handleMovement:X(function(t){if(!this.active)return;!this.isMoving&&!this.leftOnce&&(this.isMoving=!0),this.shape=this.$el.getBoundingClientRect();const e=S(this.shape);this.event==="move"&&this.isMoving&&!d()?(this.movement=N({target:this.shape,event:t}),this.eventData=c(t.clientX,t.clientY)):(this.event==="orientation"||this.event==="move"&&d())&&e?this.movement=C({target:this.shape,event:t}):this.event==="scroll"&&e&&this.shape.height&&(this.movement=T(this.shape))},100),handleMovementStart(){this.active&&(this.isMoving=!0)},handleMovementStop(){this.active&&(this.leftOnce=!0,this.isMoving=!1)}}};function R(t,e,n,i,s,r){return m(),v(w(t.tag),{onMousemove:r.handleMovement,onMouseenter:r.handleMovementStart,onMouseleave:r.handleMovementStop,style:t.style},{default:y(()=>[M(t.$slots,"default"),t.audio?(m(),v("audio",{key:0,type:"audio/mpeg",onEnded:e[1]||(e[1]=(...a)=>t.stop&&t.stop(...a)),ref:"audio"},[x("source",{src:t.audio},null,8,["src"])],544)):b("",!0)]),_:3},8,["onMousemove","onMouseenter","onMouseleave","style"])}k.render=R;var B={methods:{transformSwitch(t,e,n,i){let s;switch(t){case"translate":s=this.translateMovement(e,n);break;case"rotate":s=this.rotateMovement(e,n);break;case"depth":s=this.depthMovement(e,n,i);break;case"depth_inv":s=this.depthMovement(-e,-n,i);break;case"scale":s=this.scaleMovement(e,n);break}return s},translateMovement(t,e){return`translate3d(${-t}px, ${-e}px, 0)`},rotateMovement(t,e){let n;return this.axis?this.axis==="x"?n=2*t:this.axis==="y"&&(n=2*e):n=t+e,`rotate3d(0,0,1,${n}deg)`},depthMovement(t,e,n){return`rotateX(${-e}deg) rotateY(${t}deg) translate3d(0,0,${n*2}px)`},scaleMovement(t,e){const{type:n}=this,i=Math.sign(this.strength)*(Math.abs(t)+Math.abs(e))/10+1;return`scale3d(${n==="scaleX"||n==="scale"?i:1},
            ${n==="scaleY"||n==="scale"?i:1},
            1)`}}};function p(t){const{y:e,x:n,target:i,originX:s=50,strength:r=10,event:a=null}=t;let{originY:o=50}=t;a==="scroll"&&(o=-o/2);const l=(n-s/50)*r,h=(e-o/50)*r;return{...c(l,h),target:i}}function f(t,e,n){return n&&t>n?n:e&&t<e?e:t}function g(t){const{referencePosition:e,elementPosition:n,spanningRange:i,cycles:s}=t,r=(e-n)*(Math.PI*2)/i;return i*Math.sin(r*s)/(i/2)}var F={name:"KinesisElement",mixins:[P,B],inject:["context"],props:{tag:{type:String,default:"div"}},computed:{transform(){return this.transformMovement()},getContext(){return this.context},transformParameters(){return{transitionProperty:"transform",transitionDuration:this.transitionDuration,transformOrigin:this.transformOrigin,transitionTimingFunction:this.transitionTimingFunction}},transitionDuration(){const{duration:t}=this.context;return`${t}ms`},transitionTimingFunction(){return this.context.easing},isTouch(){return d()}},methods:{transformMovement(){const{context:t}=this;if(!t.isMoving&&t.event==="move")return{};let e,n;const i=t.event,s=this.strengthManager();if(this.cycle<=0){const{x:o,y:l}=p({...t.movement,originX:this.originX,originY:this.originY,strength:s}),h=i==="scroll";if(h||(e=this.axis==="y"?0:f(o,this.minX,this.maxX),n=this.axis==="x"?0:f(l,this.minY,this.maxY)),h){const u=p({x:t.movement.x,y:t.movement.y,originX:this.originX,originY:this.originY,strength:s,event:t.event}).y;e=this.axis==="x"?u:0,n=this.axis==="y"||!this.axis?u:0}}else if(this.cycle>0){const{shape:o,eventData:l}=t;if(o){const h=this.axis==="x"?g({referencePosition:i==="scroll"?0:l.x,elementPosition:o.left,spanningRange:i==="scroll"?window.innerWidth:o.width,cycles:this.cycle}):0,u=this.axis==="y"||!this.axis?g({referencePosition:i==="scroll"?0:l.y,elementPosition:o.top,spanningRange:i==="scroll"?window.innerHeight:o.height,cycles:this.cycle}):0;e=h*s,n=u*s}}let r=this.type;return r=r==="scaleX"||r==="scaleY"?"scale":r,{transform:this.transformSwitch(r,e,n,this.strength)}}}};function O(t,e,n,i,s,r){return m(),v(w(n.tag),{style:{...r.transform,...r.transformParameters}},{default:y(()=>[M(t.$slots,"default")]),_:3},8,["style"])}F.render=O;export{k as a,F as s};
